

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3.1. Lists &#8212; OCaml Programming: Correct + Efficient + Beautiful</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/data/lists';</script>
    <link rel="shortcut icon" href="../../_static/op.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.2. Variants" href="variants.html" />
    <link rel="prev" title="3. Data and Types" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../cover.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/op_title.png" class="logo__image only-light" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>
    <script>document.write(`<img src="../../_static/op_title.png" class="logo__image only-dark" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preface/about.html">About This Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preface/install.html">Installing OCaml</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/intro.html">1. Better Programming Through OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/past.html">1.1. The Past of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/present.html">1.2. The Present of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/future.html">1.3. Look to Your Future</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/3110.html">1.4. A Brief History of CS 3110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/summary.html">1.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/intro.html">2. The Basics of OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/toplevel.html">2.1. The OCaml Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/compiling.html">2.2. Compiling OCaml Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/expressions.html">2.3. Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/functions.html">2.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/documentation.html">2.5. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/printing.html">2.6. Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/debugging.html">2.7. Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/summary.html">2.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/exercises.html">2.9. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">OCaml Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">3. Data and Types</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.1. Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="variants.html">3.2. Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="ounit.html">3.3. Unit Testing with OUnit</a></li>
<li class="toctree-l2"><a class="reference internal" href="records_tuples.html">3.4. Records and Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="pattern_matching_advanced.html">3.5. Advanced Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="type_synonym.html">3.6. Type Synonyms</a></li>
<li class="toctree-l2"><a class="reference internal" href="options.html">3.7. Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="assoc_list.html">3.8. Association Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="algebraic_data_types.html">3.9. Algebraic Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html">3.10. Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="trees.html">3.11. Example: Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="nats.html">3.12. Example: Natural Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">3.13. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises.html">3.14. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hop/intro.html">4. Higher-Order Programming</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hop/higher_order.html">4.1. Higher-Order Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/map.html">4.2. Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/filter.html">4.3. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/fold.html">4.4. Fold</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/beyond_lists.html">4.5. Beyond Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/pipelining.html">4.6. Pipelining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/currying.html">4.7. Currying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/summary.html">4.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/exercises.html">4.9. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/intro.html">5. Modular Programming</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/module_systems.html">5.1. Module Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/modules.html">5.2. Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/toplevel.html">5.3. Modules and the Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/encapsulation.html">5.4. Encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/compilation_units.html">5.5. Compilation Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/functional_data_structures.html">5.6. Functional Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/module_type_constraints.html">5.7. Module Type Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/includes.html">5.8. Includes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/functors.html">5.9. Functors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/summary.html">5.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/exercises.html">5.11. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Correctness and Efficiency</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../correctness/intro.html">6. Correctness</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../correctness/specifications.html">6.1. Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/function_docs.html">6.2. Function Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/module_docs.html">6.3. Module Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/test_debug.html">6.4. Testing and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/black_glass_box.html">6.5. Black-box and Glass-box Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/randomized.html">6.6. Randomized Testing with QCheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/proving_correctness.html">6.7. Proving Correctness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/structural_induction.html">6.8. Structural Induction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/eq_spec.html">6.9. Equational Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/summary.html">6.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/exercises.html">6.11. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mut/intro.html">7. Mutability</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mut/refs.html">7.1. Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/mutable_fields.html">7.2. Mutable Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/arrays.html">7.3. Arrays and Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/summary.html">7.4. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/exercises.html">7.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ds/intro.html">8. Data Structures</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ds/hash_tables.html">8.1. Hash Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/amortized.html">8.2. Amortized Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/rb.html">8.3. Red-Black Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/sequence.html">8.4. Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/memoization.html">8.5. Memoization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/parrays.html">8.6. Persistent Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/promises.html">8.7. Promises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/monads.html">8.8. Monads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/summary.html">8.9. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/exercises.html">8.10. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Language Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../interp/intro.html">9. Interpreters</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../interp/calculator.html">9.1. Example: Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/parsing.html">9.2. Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/substitution.html">9.3. Substitution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/environment.html">9.4. Environment Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/typecheck.html">9.5. Type Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/inference.html">9.6. Type Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/summary.html">9.7. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/exercises.html">9.8. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lagniappe</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../adv/curry-howard.html">The Curry-Howard Correspondence</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/bigoh.html">Big-Oh Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/vm.html">Virtual Machine</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cs3110/textbook/main?urlpath=tree/src/chapters/data/lists.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cs3110/textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/edit/main/src/chapters/data/lists.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/issues/new?title=Issue%20on%20page%20%2Fchapters/data/lists.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/data/lists.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/chapters/data/lists.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lists</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-lists">3.1.1. Building Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-lists">3.1.2. Accessing Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#not-mutating-lists">3.1.3. (Not) Mutating Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pattern-matching-with-lists">3.1.4. Pattern Matching with Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-pattern-matching">3.1.5. Deep Pattern Matching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immediate-matches">3.1.6. Immediate Matches</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ocamldoc-and-list-syntax">3.1.7. OCamldoc and List Syntax</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#list-comprehensions">3.1.8. List Comprehensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-recursion">3.1.9. Tail Recursion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lists">
<h1><span class="section-number">3.1. </span>Lists<a class="headerlink" href="#lists" title="Permalink to this heading">#</a></h1>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/x8oLIEtSRBs" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>An OCaml list is a sequence of values all of which have the same type. They are
implemented as singly-linked lists. These lists enjoy a first-class status in
the language: there is special support for easily creating and working with
lists. That’s a characteristic that OCaml shares with many other functional
languages. Mainstream imperative languages, like Python, have such support these
days too. Maybe that’s because programmers find it so pleasant to work directly
with lists as a first-class part of the language, rather than having to go
through a library (as in C and Java).</p>
<section id="building-lists">
<h2><span class="section-number">3.1.1. </span>Building Lists<a class="headerlink" href="#building-lists" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/I9u4kFPM7YI" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p><strong>Syntax.</strong>  There are three syntactic forms for building lists:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="bp">[]</span>
<span class="n">e1</span> <span class="o">::</span> <span class="n">e2</span>
<span class="o">[</span><span class="n">e1</span><span class="o">;</span> <span class="n">e2</span><span class="o">;</span> <span class="o">...;</span> <span class="n">en</span><span class="o">]</span>
</pre></div>
</div>
<p>The empty list is written <code class="docutils literal notranslate"><span class="pre">[]</span></code> and is pronounced “nil”, a name that comes from
Lisp. Given a list <code class="docutils literal notranslate"><span class="pre">lst</span></code> and element <code class="docutils literal notranslate"><span class="pre">elt</span></code>, we can prepend <code class="docutils literal notranslate"><span class="pre">elt</span></code> to <code class="docutils literal notranslate"><span class="pre">lst</span></code> by
writing <code class="docutils literal notranslate"><span class="pre">elt</span> <span class="pre">::</span> <span class="pre">lst</span></code>. The double-colon operator is pronounced “cons”, a name
that comes from an operator in Lisp that <u>cons</u>tructs objects in memory.
“Cons” can also be used as a verb, as in “I will cons an element onto the list.”
The first element of a list is usually called its <em>head</em> and the rest of the
elements (if any) are called its <em>tail</em>.</p>
<p>The cons operator <code class="docutils literal notranslate"><span class="pre">::</span></code> is right associative, meaning that <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">e2</span> <span class="pre">::</span> <span class="pre">e3</span></code> is
understood as <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">(e2</span> <span class="pre">::</span> <span class="pre">e3)</span></code>, not as <code class="docutils literal notranslate"><span class="pre">(e1</span> <span class="pre">::</span> <span class="pre">e2)</span> <span class="pre">::</span> <span class="pre">e3</span></code>.</p>
<p>The square bracket syntax is convenient but unnecessary. Any list
<code class="docutils literal notranslate"><span class="pre">[e1;</span> <span class="pre">e2;</span> <span class="pre">...;</span> <span class="pre">en]</span></code> could instead be written with the more primitive nil and
cons syntax: <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">e2</span> <span class="pre">::</span> <span class="pre">...</span> <span class="pre">::</span> <span class="pre">en</span> <span class="pre">::</span> <span class="pre">[]</span></code>. When a pleasant syntax can be
defined in terms of a more primitive syntax within the language, we call the
pleasant syntax <em>syntactic sugar</em>: it makes the language “sweeter”. Transforming
the sweet syntax into the more primitive syntax is called <em>desugaring</em>.</p>
<p>Because the elements of the list can be arbitrary expressions, lists can be
nested as deeply as we like, e.g., <code class="docutils literal notranslate"><span class="pre">[[[]];</span> <span class="pre">[[1;</span> <span class="pre">2;</span> <span class="pre">3]]]</span></code>.</p>
<p><strong>Dynamic semantics.</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> is already a value.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">e1</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">v1</span></code>, and if <code class="docutils literal notranslate"><span class="pre">e2</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">v2</span></code>, then <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">e2</span></code>
evaluates to <code class="docutils literal notranslate"><span class="pre">v1</span> <span class="pre">::</span> <span class="pre">v2</span></code>.</p></li>
</ul>
<p>As a consequence of those rules and how to desugar the square-bracket notation
for lists, we have the following derived rule:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">ei</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">vi</span></code> for all <code class="docutils literal notranslate"><span class="pre">i</span></code> in <code class="docutils literal notranslate"><span class="pre">1..n</span></code>, then <code class="docutils literal notranslate"><span class="pre">[e1;</span> <span class="pre">...;</span> <span class="pre">en]</span></code>
evaluates to <code class="docutils literal notranslate"><span class="pre">[v1;</span> <span class="pre">...;</span> <span class="pre">vn]</span></code>.</p></li>
</ul>
<p>It’s starting to get tedious to write “evaluates to” in all our evaluation
rules. So let’s introduce a shorter notation for it. We’ll write <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">==&gt;</span> <span class="pre">v</span></code> to
mean that <code class="docutils literal notranslate"><span class="pre">e</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">v</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">==&gt;</span></code> is not a piece of OCaml syntax.
Rather, it’s a notation we use in our description of the language, kind of like
metavariables. Using that notation, we can rewrite the latter two rules above:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">==&gt;</span> <span class="pre">v1</span></code>, and if <code class="docutils literal notranslate"><span class="pre">e2</span> <span class="pre">==&gt;</span> <span class="pre">v2</span></code>, then <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">e2</span> <span class="pre">==&gt;</span> <span class="pre">v1</span> <span class="pre">::</span> <span class="pre">v2</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">ei</span> <span class="pre">==&gt;</span> <span class="pre">vi</span></code> for all <code class="docutils literal notranslate"><span class="pre">i</span></code> in <code class="docutils literal notranslate"><span class="pre">1..n</span></code>, then <code class="docutils literal notranslate"><span class="pre">[e1;</span> <span class="pre">...;</span> <span class="pre">en]</span> <span class="pre">==&gt;</span> <span class="pre">[v1;</span> <span class="pre">...;</span> <span class="pre">vn]</span></code>.</p></li>
</ul>
<p><strong>Static semantics.</strong></p>
<p>All the elements of a list must have the same type. If that element type is <code class="docutils literal notranslate"><span class="pre">t</span></code>,
then the type of the list is <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">list</span></code>. You should read such types from right to
left: <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">list</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">t</span></code>’s, <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">list</span> <span class="pre">list</span></code> is a list of list of <code class="docutils literal notranslate"><span class="pre">t</span></code>’s,
etc. The word <code class="docutils literal notranslate"><span class="pre">list</span></code> itself here is not a type: there is no way to build an
OCaml value that has type simply <code class="docutils literal notranslate"><span class="pre">list</span></code>. Rather, <code class="docutils literal notranslate"><span class="pre">list</span></code> is a <em>type constructor</em>:
given a type, it produces a new type. For example, given <code class="docutils literal notranslate"><span class="pre">int</span></code>, it produces the
type <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">list</span></code>. You could think of type constructors as being like functions
that operate on types, instead of functions that operate on values.</p>
<p>The type-checking rules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span> <span class="pre">:</span> <span class="pre">'a</span> <span class="pre">list</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">:</span> <span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span> <span class="pre">:</span> <span class="pre">t</span> <span class="pre">list</span></code> then <code class="docutils literal notranslate"><span class="pre">e1</span> <span class="pre">::</span> <span class="pre">e2</span> <span class="pre">:</span> <span class="pre">t</span> <span class="pre">list</span></code>. In case the colons
and their precedence is confusing, the latter means <code class="docutils literal notranslate"><span class="pre">(e1</span> <span class="pre">::</span> <span class="pre">e2)</span> <span class="pre">:</span> <span class="pre">t</span> <span class="pre">list</span></code>.</p></li>
</ul>
<p>In the rule for <code class="docutils literal notranslate"><span class="pre">[]</span></code>, recall that <code class="docutils literal notranslate"><span class="pre">'a</span></code> is a type variable: it stands for an
unknown type. So the empty list is a list whose elements have an unknown type.
If we cons an <code class="docutils literal notranslate"><span class="pre">int</span></code> onto it, say <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">::</span> <span class="pre">[]</span></code>, then the compiler infers that for
that particular list, <code class="docutils literal notranslate"><span class="pre">'a</span></code> must be <code class="docutils literal notranslate"><span class="pre">int</span></code>. But if in another place we cons a
<code class="docutils literal notranslate"><span class="pre">bool</span></code> onto it, say <code class="docutils literal notranslate"><span class="pre">true</span> <span class="pre">::</span> <span class="pre">[]</span></code>, then the compiler infers that for that
particular list, <code class="docutils literal notranslate"><span class="pre">'a</span></code> must be <code class="docutils literal notranslate"><span class="pre">bool</span></code>.</p>
</section>
<section id="accessing-lists">
<h2><span class="section-number">3.1.2. </span>Accessing Lists<a class="headerlink" href="#accessing-lists" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/AkrlDpHN_zE" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The video linked above also uses records and tuples as examples. Those are
covered in a <a class="reference internal" href="records_tuples.html"><span class="doc std std-doc">later section</span></a> of this book.</p>
</div>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/sO9wxUxajS4" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>There are really only two ways to build a list, with nil and cons. So if we want
to take apart a list into its component pieces, we have to say what to do with
the list if it’s empty, and what to do if it’s non-empty (that is, a cons of one
element onto some other list). We do that with a language feature called
<em>pattern matching</em>.</p>
<p>Here’s an example of using pattern matching to compute the sum of a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>This function says to take the input <code class="docutils literal notranslate"><span class="pre">lst</span></code> and see whether it has the same shape
as the empty list. If so, return 0. Otherwise, if it has the same shape as the
list <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">::</span> <span class="pre">t</span></code>, then let <code class="docutils literal notranslate"><span class="pre">h</span></code> be the first element of <code class="docutils literal notranslate"><span class="pre">lst</span></code>, and let <code class="docutils literal notranslate"><span class="pre">t</span></code> be the
rest of the elements of <code class="docutils literal notranslate"><span class="pre">lst</span></code>, and return <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">+</span> <span class="pre">sum</span> <span class="pre">t</span></code>. The choice of variable
names here is meant to suggest “head” and “tail” and is a common idiom, but we
could use other names if we wanted. Another common idiom is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">xs</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs&#39;</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">xs&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>That is, the input list is a list of xs (pronounced EX-uhs), the head element is
an x, and the tail is xs’ (pronounced EX-uhs prime).</p>
<p>Syntactically it isn’t necessary to use so many lines to define <code class="docutils literal notranslate"><span class="pre">sum</span></code>. We could
do it all on one line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">xs</span> <span class="o">=</span> <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span> <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span> <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs&#39;</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">xs&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>Or, noting that the first <code class="docutils literal notranslate"><span class="pre">|</span></code> after <code class="docutils literal notranslate"><span class="pre">with</span></code> is optional regardless of how many
lines we use, we could also write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">xs</span> <span class="o">=</span> <span class="k">match</span> <span class="n">xs</span> <span class="k">with</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span> <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs&#39;</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">xs&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>The multi-line format is what we’ll usually use in this book, because it helps
the human eye understand the syntax a bit better. OCaml code formatting tools,
though, are moving toward the single-line format whenever the code is short
enough to fit on just one line.</p>
<p>Here’s another example of using pattern matching to compute the length of a
list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">length</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">length</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val length : &#39;a list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>Note how we didn’t actually need the variable <code class="docutils literal notranslate"><span class="pre">h</span></code> in the right-hand side of the
pattern match. When we want to indicate the presence of some value in a pattern
without actually giving it a name, we can write <code class="docutils literal notranslate"><span class="pre">_</span></code> (the underscore character):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">length</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="o">_</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">length</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val length : &#39;a list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>That function is actually built-in as part of the OCaml standard library <code class="docutils literal notranslate"><span class="pre">List</span></code>
module. Its name there is <code class="docutils literal notranslate"><span class="pre">List.length</span></code>. That “dot” notation indicates the
function named <code class="docutils literal notranslate"><span class="pre">length</span></code> inside the module named <code class="docutils literal notranslate"><span class="pre">List</span></code>, much like the dot
notation used in many other languages.</p>
<p>And here’s a third example that appends one list onto the beginning of
another list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">append</span> <span class="n">lst1</span> <span class="n">lst2</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst1</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">lst2</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">::</span> <span class="n">append</span> <span class="n">t</span> <span class="n">lst2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val append : &#39;a list -&gt; &#39;a list -&gt; &#39;a list = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>For example, <code class="docutils literal notranslate"><span class="pre">append</span> <span class="pre">[1;</span> <span class="pre">2]</span> <span class="pre">[3;</span> <span class="pre">4]</span></code> is <code class="docutils literal notranslate"><span class="pre">[1;</span> <span class="pre">2;</span> <span class="pre">3;</span> <span class="pre">4]</span></code>. That function is actually
available as a built-in operator <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>, so we could instead write
<code class="docutils literal notranslate"><span class="pre">[1;</span> <span class="pre">2]</span> <span class="pre">&#64;</span> <span class="pre">[3;</span> <span class="pre">4]</span></code>.</p>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/VDRTatjSl0E" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>As a final example, we could write a function to determine whether
a list is empty:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">empty</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">true</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="bp">false</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val empty : &#39;a list -&gt; bool = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>But there is a much better way to write the same function without pattern matching:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">empty</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="n">lst</span> <span class="o">=</span> <span class="bp">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val empty : &#39;a list -&gt; bool = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>Note how all the recursive functions above are similar to doing proofs by
induction on the natural numbers: every natural number is either 0 or is 1
greater than some other natural number <span class="math notranslate nohighlight">\(n\)</span>, and so a proof by induction has a
base case for 0 and an inductive case for <span class="math notranslate nohighlight">\(n + 1\)</span>. Likewise, all our functions
have a base case for the empty list and a recursive case for the list that has
one more element than another list. This similarity is no accident. There is a
deep relationship between induction and recursion; we’ll explore that
relationship in more detail later in the book.</p>
<p>By the way, there are two library functions <code class="docutils literal notranslate"><span class="pre">List.hd</span></code> and <code class="docutils literal notranslate"><span class="pre">List.tl</span></code> that return
the head and tail of a list. It is not good, idiomatic OCaml to apply these
directly to a list. The problem is that they will raise an exception when
applied to the empty list, and you will have to remember to handle that
exception. Instead, you should use pattern matching: you’ll then be forced to
match against both the empty list and the non-empty list (at least), which will
prevent exceptions from being raised, thus making your program more robust.</p>
</section>
<section id="not-mutating-lists">
<h2><span class="section-number">3.1.3. </span>(Not) Mutating Lists<a class="headerlink" href="#not-mutating-lists" title="Permalink to this heading">#</a></h2>
<p>Lists are immutable. There’s no way to change an element of a list from one
value to another. Instead, OCaml programmers create new lists out of old lists.
For example, suppose we wanted to write a function that returned the same list
as its input list, but with the first element (if there is one) incremented by
one. We could do that:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">inc_first</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">::</span> <span class="n">t</span>
</pre></div>
</div>
<p>Now you might be concerned about whether we’re being wasteful of space. After
all, there are at least two ways the compiler could implement the above code:</p>
<ol class="arabic simple">
<li><p>Copy the entire tail list <code class="docutils literal notranslate"><span class="pre">t</span></code> when the new list is created in the pattern
match with cons, such that the amount of memory in use just increased by an
amount proportionate to the length of <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p>Share the tail list <code class="docutils literal notranslate"><span class="pre">t</span></code> between the old list and the new list, such that the
amount of memory in use does not increase—beyond the one extra piece of
memory needed to store <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p></li>
</ol>
<p>In fact, the compiler does the latter. So there’s no need for concern. The
reason that it’s quite safe for the compiler to implement sharing is exactly
that list elements are immutable. If they were instead mutable, then we’d start
having to worry about whether the list I have is shared with the list you have,
and whether changes I make will be visible in your list. So immutability makes
it easier to reason about the code, and makes it safe for the compiler to
perform an optimization.</p>
</section>
<section id="pattern-matching-with-lists">
<h2><span class="section-number">3.1.4. </span>Pattern Matching with Lists<a class="headerlink" href="#pattern-matching-with-lists" title="Permalink to this heading">#</a></h2>
<p>We saw above how to access lists using pattern matching. Let’s look more
carefully at this feature.</p>
<p><strong>Syntax.</strong></p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">match</span> <span class="n">e</span> <span class="k">with</span>
<span class="o">|</span> <span class="n">p1</span> <span class="o">-&gt;</span> <span class="n">e1</span>
<span class="o">|</span> <span class="n">p2</span> <span class="o">-&gt;</span> <span class="n">e2</span>
<span class="o">|</span> <span class="o">...</span>
<span class="o">|</span> <span class="n">pn</span> <span class="o">-&gt;</span> <span class="n">en</span>
</pre></div>
</div>
<p>Each of the clauses <code class="docutils literal notranslate"><span class="pre">pi</span> <span class="pre">-&gt;</span> <span class="pre">ei</span></code> is called a <em>branch</em> or a <em>case</em> of the pattern
match. The first vertical bar in the entire pattern match is optional.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">p</span></code>’s here are a new syntactic form called a <em>pattern</em>. For now, a pattern
may be:</p>
<ul class="simple">
<li><p>a variable name, e.g., <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p>the underscore character <code class="docutils literal notranslate"><span class="pre">_</span></code>, which is called the <em>wildcard</em></p></li>
<li><p>the empty list <code class="docutils literal notranslate"><span class="pre">[]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p1</span> <span class="pre">::</span> <span class="pre">p2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[p1;</span> <span class="pre">...;</span> <span class="pre">pn]</span></code></p></li>
</ul>
<p>No variable name may appear more than once in a pattern. For example, the
pattern <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">::</span> <span class="pre">x</span></code> is illegal. The wildcard may occur any number of times.</p>
<p>As we learn more of data structures available in OCaml, we’ll expand
the possibilities for what a pattern may be.</p>
<p><strong>Dynamic semantics.</strong></p>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/sz72NP4u4DQ" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>Pattern matching involves two inter-related tasks: determining whether a pattern
matches a value, and determining what parts of the value should be associated
with which variable names in the pattern. The former task is intuitively about
determining whether a pattern and a value have the same <em>shape</em>. The latter task
is about determining the <em>variable bindings</em> introduced by the pattern. For
example, consider the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">match</span> <span class="mi">1</span> <span class="o">::</span> <span class="bp">[]</span> <span class="k">with</span>
<span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">false</span>
<span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : bool = true
</pre></div>
</div>
</div>
</div>
<p>When evaluating the right-hand side of the second branch, <code class="docutils literal notranslate"><span class="pre">h</span></code> is bound to <code class="docutils literal notranslate"><span class="pre">1</span></code>
and <code class="docutils literal notranslate"><span class="pre">t</span></code> is bound to <code class="docutils literal notranslate"><span class="pre">[]</span></code>. Let’s write <code class="docutils literal notranslate"><span class="pre">h-&gt;1</span></code> to mean the variable binding saying
that <code class="docutils literal notranslate"><span class="pre">h</span></code> has value <code class="docutils literal notranslate"><span class="pre">1</span></code>; this is not a piece of OCaml syntax, but rather a
notation we use to reason about the language. So the variable bindings produced
by the second branch would be <code class="docutils literal notranslate"><span class="pre">h-&gt;1,</span> <span class="pre">t-&gt;[]</span></code>.</p>
<p>Using that notation, here is a definition of when a pattern matches a value and
the bindings that match produces:</p>
<ul class="simple">
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">x</span></code> matches any value <code class="docutils literal notranslate"><span class="pre">v</span></code> and produces the variable binding
<code class="docutils literal notranslate"><span class="pre">x-&gt;v</span></code>.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">_</span></code> matches any value and produces no bindings.</p></li>
<li><p>The pattern <code class="docutils literal notranslate"><span class="pre">[]</span></code> matches the value <code class="docutils literal notranslate"><span class="pre">[]</span></code> and produces no bindings.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">p1</span></code> matches <code class="docutils literal notranslate"><span class="pre">v1</span></code> and produces a set <span class="math notranslate nohighlight">\(b_1\)</span> of bindings, and if <code class="docutils literal notranslate"><span class="pre">p2</span></code> matches
<code class="docutils literal notranslate"><span class="pre">v2</span></code> and produces a set <span class="math notranslate nohighlight">\(b_2\)</span> of bindings, then <code class="docutils literal notranslate"><span class="pre">p1</span> <span class="pre">::</span> <span class="pre">p2</span></code> matches <code class="docutils literal notranslate"><span class="pre">v1</span> <span class="pre">::</span> <span class="pre">v2</span></code>
and produces the set <span class="math notranslate nohighlight">\(b_1 \cup b_2\)</span> of bindings. Note that <code class="docutils literal notranslate"><span class="pre">v2</span></code> must be a list
(since it’s on the right-hand side of <code class="docutils literal notranslate"><span class="pre">::</span></code>) and could have any length: 0
elements, 1 element, or many elements. Note that the union <span class="math notranslate nohighlight">\(b_1 \cup b_2\)</span> of
bindings will never have a problem where the same variable is bound separately
in both <span class="math notranslate nohighlight">\(b_1\)</span> and <span class="math notranslate nohighlight">\(b_2\)</span> because of the syntactic restriction that no variable
name may appear more than once in a pattern.</p></li>
<li><p>If for all <code class="docutils literal notranslate"><span class="pre">i</span></code> in <code class="docutils literal notranslate"><span class="pre">1..n</span></code>, it holds that <code class="docutils literal notranslate"><span class="pre">pi</span></code> matches <code class="docutils literal notranslate"><span class="pre">vi</span></code> and produces the set
<span class="math notranslate nohighlight">\(b_i\)</span> of bindings, then <code class="docutils literal notranslate"><span class="pre">[p1;</span> <span class="pre">...;</span> <span class="pre">pn]</span></code> matches <code class="docutils literal notranslate"><span class="pre">[v1;</span> <span class="pre">...;</span> <span class="pre">vn]</span></code> and produces
the set <span class="math notranslate nohighlight">\(\bigcup_i b_i\)</span> of bindings. Note that this pattern specifies the
exact length the list must be.</p></li>
</ul>
<p>Now we can say how to evaluate <code class="docutils literal notranslate"><span class="pre">match</span> <span class="pre">e</span> <span class="pre">with</span> <span class="pre">p1</span> <span class="pre">-&gt;</span> <span class="pre">e1</span> <span class="pre">|</span> <span class="pre">...</span> <span class="pre">|</span> <span class="pre">pn</span> <span class="pre">-&gt;</span> <span class="pre">en</span></code>:</p>
<ul class="simple">
<li><p>Evaluate <code class="docutils literal notranslate"><span class="pre">e</span></code> to a value <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p></li>
<li><p>Attempt to match <code class="docutils literal notranslate"><span class="pre">v</span></code> against <code class="docutils literal notranslate"><span class="pre">p1</span></code>, then against <code class="docutils literal notranslate"><span class="pre">p2</span></code>, and so on, in the order
they appear in the match expression.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">v</span></code> does not match against any of the patterns, then evaluation of the
match expression raises a <code class="docutils literal notranslate"><span class="pre">Match_failure</span></code> exception. We haven’t yet discussed
exceptions in OCaml, but you’re surely familiar with them from other
languages. We’ll come back to exceptions near the end of this chapter, after
we’ve covered some of the other built-in data structures in OCaml.</p></li>
<li><p>Otherwise, let <code class="docutils literal notranslate"><span class="pre">pi</span></code> be the first pattern that matches, and let <span class="math notranslate nohighlight">\(b\)</span> be the
variable bindings produced by matching <code class="docutils literal notranslate"><span class="pre">v</span></code> against <code class="docutils literal notranslate"><span class="pre">pi</span></code>.</p></li>
<li><p>Substitute those bindings <span class="math notranslate nohighlight">\(b\)</span> inside <code class="docutils literal notranslate"><span class="pre">ei</span></code>, producing a new expression <code class="docutils literal notranslate"><span class="pre">e'</span></code>.</p></li>
<li><p>Evaluate <code class="docutils literal notranslate"><span class="pre">e'</span></code> to a value <code class="docutils literal notranslate"><span class="pre">v'</span></code>.</p></li>
<li><p>The result of the entire match expression is <code class="docutils literal notranslate"><span class="pre">v'</span></code>.</p></li>
</ul>
<p>For example, here’s how this match expression would be evaluated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">match</span> <span class="mi">1</span> <span class="o">::</span> <span class="bp">[]</span> <span class="k">with</span>
<span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">false</span>
<span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">t</span> <span class="o">=</span> <span class="bp">[]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : bool = true
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">::</span> <span class="pre">[]</span></code> is already a value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> does not match <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">::</span> <span class="pre">[]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">::</span> <span class="pre">t</span></code> does match <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">::</span> <span class="pre">[]</span></code> and produces variable bindings
{<code class="docutils literal notranslate"><span class="pre">h-&gt;1</span></code>,<code class="docutils literal notranslate"><span class="pre">t-&gt;[]</span></code>}, because:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">h</span></code> matches <code class="docutils literal notranslate"><span class="pre">1</span></code> and produces the variable binding <code class="docutils literal notranslate"><span class="pre">h-&gt;1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> matches <code class="docutils literal notranslate"><span class="pre">[]</span></code> and produces the variable binding <code class="docutils literal notranslate"><span class="pre">t-&gt;[]</span></code>.</p></li>
</ul>
</li>
<li><p>Substituting {<code class="docutils literal notranslate"><span class="pre">h-&gt;1</span></code>,<code class="docutils literal notranslate"><span class="pre">t-&gt;[]</span></code>} inside <code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">&amp;&amp;</span> <span class="pre">t</span> <span class="pre">=</span> <span class="pre">[]</span></code>
produces a new expression <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">&amp;&amp;</span> <span class="pre">[]</span> <span class="pre">=</span> <span class="pre">[]</span></code>.</p></li>
<li><p>Evaluating <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">=</span> <span class="pre">1</span> <span class="pre">&amp;&amp;</span> <span class="pre">[]</span> <span class="pre">=</span> <span class="pre">[]</span></code> yields the value <code class="docutils literal notranslate"><span class="pre">true</span></code>. We omit the
justification for that fact here, but it follows from other evaluation rules
for built-in operators and function application.</p></li>
<li><p>So the result of the entire match expression is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
</ul>
<p><strong>Static semantics.</strong></p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">e</span> <span class="pre">:</span> <span class="pre">ta</span></code> and for all <code class="docutils literal notranslate"><span class="pre">i</span></code>, it holds that <code class="docutils literal notranslate"><span class="pre">pi</span> <span class="pre">:</span> <span class="pre">ta</span></code> and <code class="docutils literal notranslate"><span class="pre">ei</span> <span class="pre">:</span> <span class="pre">tb</span></code>,
then <code class="docutils literal notranslate"><span class="pre">(match</span> <span class="pre">e</span> <span class="pre">with</span> <span class="pre">p1</span> <span class="pre">-&gt;</span> <span class="pre">e1</span> <span class="pre">|</span> <span class="pre">...</span> <span class="pre">|</span> <span class="pre">pn</span> <span class="pre">-&gt;</span> <span class="pre">en)</span> <span class="pre">:</span> <span class="pre">tb</span></code>.</p></li>
</ul>
<p>That rule relies on being able to judge whether a pattern has a particular type.
As usual, type inference comes into play here. The OCaml compiler infers the
types of any pattern variables as well as all occurrences of the wildcard
pattern. As for the list patterns, they have the same type-checking rules as
list expressions.</p>
<p><strong>Additional Static Checking.</strong></p>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/aLQJpk9vXD4" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>In addition to that type-checking rule, there are two other checks the compiler
does for each match expression.</p>
<p>First, <strong>exhaustiveness:</strong> the compiler checks to make sure that there are
enough patterns to guarantee that at least one of them matches the expression
<code class="docutils literal notranslate"><span class="pre">e</span></code>, no matter what the value of that expression is at run time. This ensures
that the programmer did not forget any branches. For example, the function below
will cause the compiler to emit a warning:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">head</span> <span class="n">lst</span> <span class="o">=</span> <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span> <span class="n">h</span> <span class="o">::</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="n">h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File &quot;[12]&quot;, line 1, characters 15-41:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 | let head lst = match lst with h :: _ -&gt; h
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning 8 [partial-match]: this pattern-matching is not exhaustive.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Here is an example of a case that is not matched:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val head : &#39;a list -&gt; &#39;a = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>By presenting that warning to the programmer, the compiler is helping the
programmer to defend against the possibility of <code class="docutils literal notranslate"><span class="pre">Match_failure</span></code> exceptions at
runtime.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sorry about how the output from the cell above gets split into many lines in the
HTML. That is currently an <a class="reference external" href="https://github.com/executablebooks/jupyter-book/issues/973">open issue with JupyterBook</a>, the framework
used to build this book.</p>
</div>
<p>Second, <strong>unused branches:</strong> the compiler checks to see whether any of the
branches could never be matched against because one of the previous branches is
guaranteed to succeed. For example, the function below will cause the compiler
to emit a warning:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">t</span>
  <span class="o">|</span> <span class="o">[</span> <span class="n">h</span> <span class="o">]</span> <span class="o">-&gt;</span> <span class="n">h</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File &quot;[13]&quot;, line 4, characters 4-9:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 |   | [ h ] -&gt; h
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ^^^^^
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning 11 [redundant-case]: this match case is unused.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>The second branch is unused because the first branch will match anything the
second branch matches.</p>
<p>Unused match cases are usually a sign that the programmer wrote something other
than what they intended. So by presenting that warning, the compiler is helping
the programmer to detect latent bugs in their code.</p>
<p>Here’s an example of one of the most common bugs that causes an unused match
case warning. Understanding it is also a good way to check your understanding of
the dynamic semantics of match expressions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">length_is</span> <span class="n">lst</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">match</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="bp">true</span>
  <span class="o">|</span> <span class="o">_</span> <span class="o">-&gt;</span> <span class="bp">false</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File &quot;[14]&quot;, line 4, characters 4-5:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 |   | _ -&gt; false
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        ^
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning 11 [redundant-case]: this match case is unused.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val length_is : &#39;a list -&gt; &#39;b -&gt; bool = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>The programmer was thinking that if the length of <code class="docutils literal notranslate"><span class="pre">lst</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">n</span></code>, then
this function will return <code class="docutils literal notranslate"><span class="pre">true</span></code>, and otherwise will return <code class="docutils literal notranslate"><span class="pre">false</span></code>. But in fact
this function <em>always</em> returns <code class="docutils literal notranslate"><span class="pre">true</span></code>. Why? Because the pattern variable <code class="docutils literal notranslate"><span class="pre">n</span></code> is
distinct from the function argument <code class="docutils literal notranslate"><span class="pre">n</span></code>. Suppose that the length of <code class="docutils literal notranslate"><span class="pre">lst</span></code> is 5.
Then the pattern match becomes: <code class="docutils literal notranslate"><span class="pre">match</span> <span class="pre">5</span> <span class="pre">with</span> <span class="pre">n</span> <span class="pre">-&gt;</span> <span class="pre">true</span> <span class="pre">|</span> <span class="pre">_</span> <span class="pre">-&gt;</span> <span class="pre">false</span></code>. Does <code class="docutils literal notranslate"><span class="pre">n</span></code>
match 5? Yes, according to the rules above: a variable pattern matches any value
and here produces the binding <code class="docutils literal notranslate"><span class="pre">n-&gt;5</span></code>. Then evaluation applies that binding to
<code class="docutils literal notranslate"><span class="pre">true</span></code>, substituting all occurrences of <code class="docutils literal notranslate"><span class="pre">n</span></code> inside of <code class="docutils literal notranslate"><span class="pre">true</span></code> with 5. Well, there
are no such occurrences. So we’re done, and the result of evaluation is just
<code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>What the programmer really meant to write was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">length_is</span> <span class="n">lst</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">match</span> <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="n">m</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val length_is : &#39;a list -&gt; int -&gt; bool = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>or better yet:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">length_is</span> <span class="n">lst</span> <span class="n">n</span> <span class="o">=</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">length</span> <span class="n">lst</span> <span class="o">=</span> <span class="n">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val length_is : &#39;a list -&gt; int -&gt; bool = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="deep-pattern-matching">
<h2><span class="section-number">3.1.5. </span>Deep Pattern Matching<a class="headerlink" href="#deep-pattern-matching" title="Permalink to this heading">#</a></h2>
<p>Patterns can be nested.  Doing so can allow your code to look deeply into the
structure of a list.  For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">::</span> <span class="pre">[]</span></code> matches all lists with exactly one element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">::</span> <span class="pre">_</span></code> matches all lists with at least one element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">::</span> <span class="pre">_</span> <span class="pre">::</span> <span class="pre">[]</span></code> matches all lists with exactly two elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_</span> <span class="pre">::</span> <span class="pre">_</span> <span class="pre">::</span> <span class="pre">_</span> <span class="pre">::</span> <span class="pre">_</span></code> matches all lists with at least three elements</p></li>
</ul>
</section>
<section id="immediate-matches">
<h2><span class="section-number">3.1.6. </span>Immediate Matches<a class="headerlink" href="#immediate-matches" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/VgVP8Tin6yY" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>When you have a function that immediately pattern-matches against its final
argument, there’s a nice piece of syntactic sugar you can use to avoid writing
extra code. Here’s an example: instead of</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>you can write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="o">=</span> <span class="k">function</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">h</span> <span class="o">+</span> <span class="n">sum</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>The word <code class="docutils literal notranslate"><span class="pre">function</span></code> is a keyword. Notice that we’re able to leave out the line
containing <code class="docutils literal notranslate"><span class="pre">match</span></code> as well as the name of the argument, which was never used
anywhere else but that line. In such cases, though, it’s especially important in
the specification comment for the function to document what that argument is
supposed to be, since the code no longer gives it a descriptive name.</p>
</section>
<section id="ocamldoc-and-list-syntax">
<h2><span class="section-number">3.1.7. </span>OCamldoc and List Syntax<a class="headerlink" href="#ocamldoc-and-list-syntax" title="Permalink to this heading">#</a></h2>
<p>OCamldoc is a documentation generator similar to Javadoc. It extracts comments
from source code and produces HTML (as well as other output formats). The
<a class="reference external" href="https://ocaml.org/api/List.html">standard library web documentation</a> for the List module is generated
by OCamldoc from the <a class="reference external" href="https://github.com/ocaml/ocaml/blob/trunk/stdlib/list.mli">standard library source code</a> for that module,
for example.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is a syntactic convention with square brackets in OCamldoc that can be
confusing with respect to lists.</p>
<p>In an OCamldoc comment, source code is surrounded by square brackets. That code
will be rendered in typewriter face and syntax-highlighted in the output HTML.
The square brackets in this case do not indicate a list.</p>
</div>
<p>For example, here is the comment for <code class="docutils literal notranslate"><span class="pre">List.hd</span></code> in the standard library source
code:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(** Return the first element of the given list. Raise</span>
<span class="c">   [Failure &quot;hd&quot;] if the list is empty. *)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[Failure</span> <span class="pre">&quot;hd&quot;]</span></code> does not mean a list containing the exception
<code class="docutils literal notranslate"><span class="pre">Failure</span> <span class="pre">&quot;hd&quot;</span></code>. Rather it means to typeset the expression <code class="docutils literal notranslate"><span class="pre">Failure</span> <span class="pre">&quot;hd&quot;</span></code> as
source code, as you can see <a class="reference external" href="https://ocaml.org/api/List.html">here</a>.</p>
<p>This can get especially confusing when you want to talk about lists as part of
the documentation. For example, here is a way we could rewrite that comment:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(** [hd lst] returns the first element of [lst].</span>
<span class="c">    Raises [Failure &quot;hd&quot;] if [lst = []]. *)</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">[lst</span> <span class="pre">=</span> <span class="pre">[]]</span></code>, the outer square brackets indicate source code as part of a
comment, whereas the inner square brackets indicate the empty list.</p>
</section>
<section id="list-comprehensions">
<h2><span class="section-number">3.1.8. </span>List Comprehensions<a class="headerlink" href="#list-comprehensions" title="Permalink to this heading">#</a></h2>
<p>Some languages, including Python and Haskell, have a syntax called
<em>comprehension</em> that allows lists to be written somewhat like set comprehensions
from mathematics. The earliest example of comprehensions seems to be the
functional language NPL, which was designed in 1977.</p>
<p>OCaml doesn’t have built-in syntactic support for comprehensions. Though some
extensions were developed, none seem to be supported any longer. The primary
tasks accomplished by comprehensions (filtering out some elements, and
transforming others) are actually well-supported already by <em>higher-order
programming</em>, which we’ll study in a later chapter, and the pipeline operator,
which we’ve already learned. So an additional syntax for comprehensions was
never really needed.</p>
</section>
<section id="tail-recursion">
<h2><span class="section-number">3.1.9. </span>Tail Recursion<a class="headerlink" href="#tail-recursion" title="Permalink to this heading">#</a></h2>
<p>Recall that a function is <em>tail recursive</em> if it calls itself recursively but
does not perform any computation after the recursive call returns, and
immediately returns to its caller the value of its recursive call. Consider
these two implementations, <code class="docutils literal notranslate"><span class="pre">sum</span></code> and <code class="docutils literal notranslate"><span class="pre">sum_tr</span></code> of summing a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="k">rec</span> <span class="n">sum</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span><span class="o">)</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="o">(</span><span class="n">sum</span> <span class="n">xs</span><span class="o">)</span>

<span class="k">let</span> <span class="k">rec</span> <span class="n">sum_plus_acc</span> <span class="o">(</span><span class="n">acc</span> <span class="o">:</span> <span class="kt">int</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span><span class="o">)</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">acc</span>
  <span class="o">|</span> <span class="n">x</span> <span class="o">::</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="n">sum_plus_acc</span> <span class="o">(</span><span class="n">acc</span> <span class="o">+</span> <span class="n">x</span><span class="o">)</span> <span class="n">xs</span>

<span class="k">let</span> <span class="n">sum_tr</span> <span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">=</span>
  <span class="n">sum_plus_acc</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum_plus_acc : int -&gt; int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val sum_tr : int list -&gt; int = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>Observe the following difference between the <code class="docutils literal notranslate"><span class="pre">sum</span></code> and <code class="docutils literal notranslate"><span class="pre">sum_tr</span></code> functions above:
In the <code class="docutils literal notranslate"><span class="pre">sum</span></code> function, which is not tail recursive, after the recursive call
returned its value, we add <code class="docutils literal notranslate"><span class="pre">x</span></code> to it. In the tail recursive <code class="docutils literal notranslate"><span class="pre">sum_tr</span></code>, or rather
in <code class="docutils literal notranslate"><span class="pre">sum_plus_acc</span></code>, after the recursive call returns, we immediately return the
value without further computation.</p>
<p>If you’re going to write functions on really long lists, tail recursion becomes
important for performance. So when you have a choice between using a
tail-recursive vs. non-tail-recursive function, you are likely better off using
the tail-recursive function on really long lists to achieve space efficiency.
For that reason, the List module documents which functions are tail recursive
and which are not.</p>
<p>But that doesn’t mean that a tail-recursive implementation is strictly better.
For example, the tail-recursive function might be harder to read. (Consider
<code class="docutils literal notranslate"><span class="pre">sum_plus_acc</span></code>.) Also, there are cases where implementing a tail-recursive
function entails having to do a pre- or post-processing pass to reverse the
list. On small- to medium-sized lists, the overhead of reversing the list (both
in time and in allocating memory for the reversed list) can make the
tail-recursive version less time efficient. What constitutes “small” vs. “big”
here? That’s hard to say, but maybe 10,000 is a good estimate, according to the
<a class="reference external" href="https://ocaml.org/api/List.html">standard library documentation of the <code class="docutils literal notranslate"><span class="pre">List</span></code> module</a>.</p>
<p>Here is a useful tail-recursive function to produce a long list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="c">(** [from i j l] is the list containing the integers from [i] to [j],</span>
<span class="c">    inclusive, followed by the list [l].</span>
<span class="c">    Example:  [from 1 3 [0] = [1; 2; 3; 0]] *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">from</span> <span class="n">i</span> <span class="n">j</span> <span class="n">l</span> <span class="o">=</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span> <span class="k">then</span> <span class="n">l</span> <span class="k">else</span> <span class="n">from</span> <span class="n">i</span> <span class="o">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="o">::</span> <span class="n">l</span><span class="o">)</span>

<span class="c">(** [i -- j] is the list containing the integers from [i] to [j], inclusive. *)</span>
<span class="k">let</span> <span class="o">(</span> <span class="o">--</span> <span class="o">)</span> <span class="n">i</span> <span class="n">j</span> <span class="o">=</span> <span class="n">from</span> <span class="n">i</span> <span class="n">j</span> <span class="bp">[]</span>

<span class="k">let</span> <span class="n">long_list</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">--</span> <span class="mi">1_000_000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val from : int -&gt; int -&gt; int list -&gt; int list = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val ( -- ) : int -&gt; int -&gt; int list = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val long_list : int list =
  [0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17; 18; 19; 20;
   21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38;
   39; 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 50; 51; 52; 53; 54; 55; 56;
   57; 58; 59; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 70; 71; 72; 73; 74;
   75; 76; 77; 78; 79; 80; 81; 82; 83; 84; 85; 86; 87; 88; 89; 90; 91; 92;
   93; 94; 95; 96; 97; 98; 99; 100; 101; 102; 103; 104; 105; 106; 107; 108;
   109; 110; 111; 112; 113; 114; 115; 116; 117; 118; 119; 120; 121; 122; 123;
   124; 125; 126; 127; 128; 129; 130; 131; 132; 133; 134; 135; 136; 137; 138;
   139; 140; 141; 142; 143; 144; 145; 146; 147; 148; 149; 150; 151; 152; 153;
   154; 155; 156; 157; 158; 159; 160; 161; 162; 163; 164; 165; 166; 167; 168;
   169; 170; 171; 172; 173; 174; 175; 176; 177; 178; 179; 180; 181; 182; 183;
   184; 185; 186; 187; 188; 189; 190; 191; 192; 193; 194; 195; 196; 197; 198;
   199; 200; 201; 202; 203; 204; 205; 206; 207; 208; 209; 210; 211; 212; 213;
   214; 215; 216; 217; 218; 219; 220; 221; 222; 223; 224; 225; 226; 227; 228;
   229; 230; 231; 232; 233; 234; 235; 236; 237; 238; 239; 240; 241; 242; 243;
   244; 245; 246; 247; 248; 249; 250; 251; 252; 253; 254; 255; 256; 257; 258;
   259; 260; 261; 262; 263; 264; 265; 266; 267; 268; 269; 270; 271; 272; 273;
   274; 275; 276; 277; 278; 279; 280; 281; 282; 283; 284; 285; 286; 287; 288;
   289; 290; 291; 292; 293; 294; 295; 296; 297; 298; ...]
</pre></div>
</div>
</div>
</div>
<p>It would be worthwhile to study the definition of <code class="docutils literal notranslate"><span class="pre">--</span></code> to convince yourself that
you understand (i) how it works and (ii) why it is tail recursive.</p>
<p>You might in the future decide you want to create such a list again. Rather than
having to remember where this definition is, and having to copy it into your
code, here’s an easy way to create the same list using a built-in library
function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">List</span><span class="p">.</span><span class="n">init</span> <span class="mi">1_000_000</span> <span class="nn">Fun</span><span class="p">.</span><span class="n">id</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : int list =
[0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17; 18; 19; 20;
 21; 22; 23; 24; 25; 26; 27; 28; 29; 30; 31; 32; 33; 34; 35; 36; 37; 38; 39;
 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 50; 51; 52; 53; 54; 55; 56; 57; 58;
 59; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 70; 71; 72; 73; 74; 75; 76; 77;
 78; 79; 80; 81; 82; 83; 84; 85; 86; 87; 88; 89; 90; 91; 92; 93; 94; 95; 96;
 97; 98; 99; 100; 101; 102; 103; 104; 105; 106; 107; 108; 109; 110; 111; 112;
 113; 114; 115; 116; 117; 118; 119; 120; 121; 122; 123; 124; 125; 126; 127;
 128; 129; 130; 131; 132; 133; 134; 135; 136; 137; 138; 139; 140; 141; 142;
 143; 144; 145; 146; 147; 148; 149; 150; 151; 152; 153; 154; 155; 156; 157;
 158; 159; 160; 161; 162; 163; 164; 165; 166; 167; 168; 169; 170; 171; 172;
 173; 174; 175; 176; 177; 178; 179; 180; 181; 182; 183; 184; 185; 186; 187;
 188; 189; 190; 191; 192; 193; 194; 195; 196; 197; 198; 199; 200; 201; 202;
 203; 204; 205; 206; 207; 208; 209; 210; 211; 212; 213; 214; 215; 216; 217;
 218; 219; 220; 221; 222; 223; 224; 225; 226; 227; 228; 229; 230; 231; 232;
 233; 234; 235; 236; 237; 238; 239; 240; 241; 242; 243; 244; 245; 246; 247;
 248; 249; 250; 251; 252; 253; 254; 255; 256; 257; 258; 259; 260; 261; 262;
 263; 264; 265; 266; 267; 268; 269; 270; 271; 272; 273; 274; 275; 276; 277;
 278; 279; 280; 281; 282; 283; 284; 285; 286; 287; 288; 289; 290; 291; 292;
 293; 294; 295; 296; 297; 298; ...]
</pre></div>
</div>
</div>
</div>
<p>Expression <code class="docutils literal notranslate"><span class="pre">List.init</span> <span class="pre">len</span> <span class="pre">f</span></code> creates the list <code class="docutils literal notranslate"><span class="pre">[f</span> <span class="pre">0;</span> <span class="pre">f</span> <span class="pre">1;</span> <span class="pre">...;</span> <span class="pre">f</span> <span class="pre">(len</span> <span class="pre">-</span> <span class="pre">1)]</span></code>,
and it does so tail recursively if <code class="docutils literal notranslate"><span class="pre">len</span></code> is bigger than 10,000. Function
<code class="docutils literal notranslate"><span class="pre">Fun.id</span></code> is simply the identify function <code class="docutils literal notranslate"><span class="pre">fun</span> <span class="pre">x</span> <span class="pre">-&gt;</span> <span class="pre">x</span></code>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cs3110/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ocaml-jupyter"
        },
        kernelOptions: {
            name: "ocaml-jupyter",
            path: "./chapters/data"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ocaml-jupyter'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Data and Types</p>
      </div>
    </a>
    <a class="right-next"
       href="variants.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Variants</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#building-lists">3.1.1. Building Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-lists">3.1.2. Accessing Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#not-mutating-lists">3.1.3. (Not) Mutating Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pattern-matching-with-lists">3.1.4. Pattern Matching with Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-pattern-matching">3.1.5. Deep Pattern Matching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#immediate-matches">3.1.6. Immediate Matches</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ocamldoc-and-list-syntax">3.1.7. OCamldoc and List Syntax</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#list-comprehensions">3.1.8. List Comprehensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tail-recursion">3.1.9. Tail Recursion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael R. Clarkson et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>