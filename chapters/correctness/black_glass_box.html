

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.5. Black-box and Glass-box Testing &#8212; OCaml Programming: Correct + Efficient + Beautiful</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/correctness/black_glass_box';</script>
    <link rel="shortcut icon" href="../../_static/op.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.6. Randomized Testing with QCheck" href="randomized.html" />
    <link rel="prev" title="6.4. Testing and Debugging" href="test_debug.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../cover.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/op_title.png" class="logo__image only-light" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>
    <script>document.write(`<img src="../../_static/op_title.png" class="logo__image only-dark" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preface/about.html">About This Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preface/install.html">Installing OCaml</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/intro.html">1. Better Programming Through OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/past.html">1.1. The Past of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/present.html">1.2. The Present of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/future.html">1.3. Look to Your Future</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/3110.html">1.4. A Brief History of CS 3110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/summary.html">1.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/intro.html">2. The Basics of OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/toplevel.html">2.1. The OCaml Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/compiling.html">2.2. Compiling OCaml Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/expressions.html">2.3. Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/functions.html">2.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/documentation.html">2.5. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/printing.html">2.6. Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/debugging.html">2.7. Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/summary.html">2.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/exercises.html">2.9. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">OCaml Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/intro.html">3. Data and Types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/lists.html">3.1. Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/variants.html">3.2. Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/ounit.html">3.3. Unit Testing with OUnit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/records_tuples.html">3.4. Records and Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pattern_matching_advanced.html">3.5. Advanced Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/type_synonym.html">3.6. Type Synonyms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/options.html">3.7. Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/assoc_list.html">3.8. Association Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/algebraic_data_types.html">3.9. Algebraic Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/exceptions.html">3.10. Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/trees.html">3.11. Example: Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/nats.html">3.12. Example: Natural Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/summary.html">3.13. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/exercises.html">3.14. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hop/intro.html">4. Higher-Order Programming</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hop/higher_order.html">4.1. Higher-Order Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/map.html">4.2. Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/filter.html">4.3. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/fold.html">4.4. Fold</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/beyond_lists.html">4.5. Beyond Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/pipelining.html">4.6. Pipelining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/currying.html">4.7. Currying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/summary.html">4.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/exercises.html">4.9. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/intro.html">5. Modular Programming</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/module_systems.html">5.1. Module Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/modules.html">5.2. Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/toplevel.html">5.3. Modules and the Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/encapsulation.html">5.4. Encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/compilation_units.html">5.5. Compilation Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/functional_data_structures.html">5.6. Functional Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/module_type_constraints.html">5.7. Module Type Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/includes.html">5.8. Includes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/functors.html">5.9. Functors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/summary.html">5.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/exercises.html">5.11. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Correctness and Efficiency</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">6. Correctness</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="specifications.html">6.1. Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="function_docs.html">6.2. Function Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_docs.html">6.3. Module Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_debug.html">6.4. Testing and Debugging</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.5. Black-box and Glass-box Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="randomized.html">6.6. Randomized Testing with QCheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="proving_correctness.html">6.7. Proving Correctness</a></li>
<li class="toctree-l2"><a class="reference internal" href="structural_induction.html">6.8. Structural Induction</a></li>
<li class="toctree-l2"><a class="reference internal" href="eq_spec.html">6.9. Equational Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">6.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises.html">6.11. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mut/intro.html">7. Mutability</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mut/refs.html">7.1. Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/mutable_fields.html">7.2. Mutable Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/arrays.html">7.3. Arrays and Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/summary.html">7.4. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/exercises.html">7.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ds/intro.html">8. Data Structures</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ds/hash_tables.html">8.1. Hash Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/amortized.html">8.2. Amortized Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/rb.html">8.3. Red-Black Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/sequence.html">8.4. Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/memoization.html">8.5. Memoization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/parrays.html">8.6. Persistent Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/promises.html">8.7. Promises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/monads.html">8.8. Monads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/summary.html">8.9. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/exercises.html">8.10. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Language Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../interp/intro.html">9. Interpreters</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../interp/calculator.html">9.1. Example: Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/parsing.html">9.2. Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/substitution.html">9.3. Substitution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/environment.html">9.4. Environment Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/typecheck.html">9.5. Type Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/inference.html">9.6. Type Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/summary.html">9.7. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/exercises.html">9.8. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lagniappe</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../adv/curry-howard.html">The Curry-Howard Correspondence</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/bigoh.html">Big-Oh Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/vm.html">Virtual Machine</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cs3110/textbook/main?urlpath=tree/src/chapters/correctness/black_glass_box.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cs3110/textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/edit/main/src/chapters/correctness/black_glass_box.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/issues/new?title=Issue%20on%20page%20%2Fchapters/correctness/black_glass_box.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/correctness/black_glass_box.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/chapters/correctness/black_glass_box.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Black-box and Glass-box Testing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-testing">6.5.1. Black-box Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-testing-of-data-abstractions">6.5.2. Black-box Testing of Data Abstractions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glass-box-testing">6.5.3. Glass-box Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glass-box-testing-of-data-abstractions">6.5.4. Glass-box Testing of Data Abstractions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-vs-glass-box">6.5.5. Black-box vs. Glass-box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bisect">6.5.6. Bisect</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="black-box-and-glass-box-testing">
<h1><span class="section-number">6.5. </span>Black-box and Glass-box Testing<a class="headerlink" href="#black-box-and-glass-box-testing" title="Permalink to this heading">#</a></h1>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/W8FEhZIpYCg" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>We would like to know that a program works on all possible inputs. The problem
with testing is that it is usually infeasible to try all the possible inputs.
For example, suppose that we are implementing a module that provides an abstract
data type for rational numbers. One of its operations might be an addition
function <code class="docutils literal notranslate"><span class="pre">plus</span></code>, e.g.:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">RATIONAL</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="c">(** A [t] is a rational. *)</span>
  <span class="k">type</span> <span class="n">t</span>

  <span class="c">(** [create p q] is the rational number [p/q].</span>
<span class="c">      Raises: [Invalid_argument &quot;0&quot;] if [q] is 0. *)</span>
  <span class="k">val</span> <span class="n">create</span> <span class="o">:</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="n">t</span>

  <span class="c">(** [plus r1 r2] is [r1 + r2]. *)</span>
  <span class="k">val</span> <span class="n">plus</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
<span class="k">end</span>

<span class="k">module</span> <span class="nc">Rational</span> <span class="o">:</span> <span class="nc">RATIONAL</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="c">(** AF: [(p, q)] represents the rational number [p/q].</span>
<span class="c">      RI: [q] is not 0. *)</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span> <span class="o">*</span> <span class="kt">int</span>

  <span class="k">let</span> <span class="n">create</span> <span class="n">p</span> <span class="n">q</span> <span class="o">=</span>
    <span class="k">if</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="n">invalid_arg</span> <span class="s2">&quot;0&quot;</span> <span class="k">else</span> <span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="n">q</span><span class="o">)</span>

  <span class="k">let</span> <span class="n">plus</span> <span class="o">(</span><span class="n">p1</span><span class="o">,</span> <span class="n">q1</span><span class="o">)</span> <span class="o">(</span><span class="n">p2</span><span class="o">,</span> <span class="n">q2</span><span class="o">)</span> <span class="o">=</span>
    <span class="o">(</span><span class="n">p1</span> <span class="o">*</span> <span class="n">q2</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">*</span> <span class="n">q1</span><span class="o">,</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="o">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type RATIONAL =
  sig type t val create : int -&gt; int -&gt; t val plus : t -&gt; t -&gt; t end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module Rational : RATIONAL
</pre></div>
</div>
</div>
</details>
</div>
<p>What would it take to exhaustively test just this one function? We’d want to try
all possible rationals as both the <code class="docutils literal notranslate"><span class="pre">r1</span></code> and <code class="docutils literal notranslate"><span class="pre">r2</span></code> arguments. A rational is formed
from two ints, and there are <span class="math notranslate nohighlight">\(2^{63}\)</span> ints on a modern OCaml implementation.
Therefore there are approximately <span class="math notranslate nohighlight">\((2^{63})^4 = 2^{252}\)</span> possible inputs to the
<code class="docutils literal notranslate"><span class="pre">plus</span></code> function. Even if we test one addition every nanosecond, it will take
about <span class="math notranslate nohighlight">\(10^{59}\)</span> years to finish testing this one function.</p>
<p>Clearly we can’t test software exhaustively. But that doesn’t mean we should
give up on testing. It just means that we need to think carefully about what our
test cases should be so that they are as effective as possible at convincing us
that the code works.</p>
<p>Consider our <code class="docutils literal notranslate"><span class="pre">create</span></code> function, above. It takes in two integers <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> as
arguments. How should we go about selecting a relatively small number of test
cases that will convince us that the function works correctly on all possible
inputs? We can visualize the space of all possible inputs as a large square:</p>
<p><img alt="" src="../../_images/create_inputs.png" /></p>
<p>There are about <span class="math notranslate nohighlight">\(2^{126}\)</span> points in this square, so we can’t afford to test them
all. And testing them all is going to mostly be a waste of time—most of
the possible inputs provide nothing new. We need a way to find a set of points
in this space to test that are interesting and will give a good sense of the
behavior of the program across the whole space.</p>
<p>Input spaces generally comprise a number of subsets in which the behavior of the
code is similar in some essential fashion across the entire subset. We don’t get
any additional information by testing more than one input from each such subset.</p>
<p>If we test all the interesting regions of the input space, we have achieved good
<em>coverage</em>. We want tests that in some useful sense cover the space of possible
program inputs.</p>
<p>Two good ways of achieving coverage are <em>black-box testing</em> and <em>glass-box
testing</em>. We discuss those, next.</p>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/PmfQ9xS2YhQ" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<section id="black-box-testing">
<h2><span class="section-number">6.5.1. </span>Black-box Testing<a class="headerlink" href="#black-box-testing" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/2GjVqe9IKEk" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>In selecting our test cases for good coverage, we might want to consider both
the specification and the implementation of the program or module being tested.
It turns out that we can often do a pretty good job of picking test cases by
just looking at the specification and ignoring the implementation. This is known
as <strong>black-box testing</strong>. The idea is that we think of the code as a black box
about which all we can see is its surface: its specification. We pick test cases
by looking at how the specification implicitly introduces boundaries that divide
the space of possible inputs into different regions.</p>
<p>When writing black-box test cases, we ask ourselves what set of test cases that
will produce distinctive behavior as predicted by the specification. It is
important to try out both <em>typical inputs</em> and inputs that are <em>boundary cases</em>
aka <em>corner cases</em> or <em>edge cases</em>. A common error is to only test typical
inputs, with the result that the program usually works but fails in less
frequent situations. It’s also important to identify ways in which the
specification creates classes of inputs that should elicit similar behavior from
the function, and to test on those <em>paths through the specification</em>. Here are
some examples.</p>
<p><strong>Example 1.</strong></p>
<p>Here are some ideas for how to test the <code class="docutils literal notranslate"><span class="pre">create</span></code> function:</p>
<ul class="simple">
<li><p>Looking at the square above, we see that it has boundaries at <code class="docutils literal notranslate"><span class="pre">min_int</span></code> and
<code class="docutils literal notranslate"><span class="pre">max_int</span></code>. We want to try to construct rationals at the corners and along the
sides of the square, e.g., <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">min_int</span> <span class="pre">min_int</span></code>, <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">max_int</span> <span class="pre">2</span></code>, etc.</p></li>
<li><p>The line <code class="docutils literal notranslate"><span class="pre">p=0</span></code> is important because <code class="docutils literal notranslate"><span class="pre">p/q</span></code> is zero all along it. We should try
<code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">q)</span></code> for various values of <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p></li>
<li><p>We should try some typical <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">q)</span></code> pairs in all four quadrants of the space.</p></li>
<li><p>We should try both <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">q)</span></code> pairs in which <code class="docutils literal notranslate"><span class="pre">q</span></code> divides evenly into <code class="docutils literal notranslate"><span class="pre">p</span></code>, and
pairs in which <code class="docutils literal notranslate"><span class="pre">q</span></code> does not divide into <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
<li><p>Pairs of the form <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">q)</span></code>, <code class="docutils literal notranslate"><span class="pre">(-1,</span> <span class="pre">q)</span></code>, <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">1)</span></code>, <code class="docutils literal notranslate"><span class="pre">(p,</span> <span class="pre">-1)</span></code> for various <code class="docutils literal notranslate"><span class="pre">p</span></code> and
<code class="docutils literal notranslate"><span class="pre">q</span></code> also may be interesting given the properties of rational numbers.</p></li>
</ul>
<p>The specification also says that the code will check that <code class="docutils literal notranslate"><span class="pre">q</span></code> is not zero. We
should construct some test cases to ensure this checking is done as advertised.
Trying <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(max_int,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(min_int,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(-1,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> to see that
they all raise the specified exception would probably be an adequate set of
black-box tests.</p>
<p><strong>Example 2.</strong></p>
<p>Consider a function <code class="docutils literal notranslate"><span class="pre">list_max</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(** Return the maximum element in the list. *)</span>
<span class="k">val</span> <span class="n">list_max</span><span class="o">:</span> <span class="kt">int</span> <span class="kt">list</span> <span class="o">-&gt;</span> <span class="kt">int</span>
</pre></div>
</div>
<p>What is a good set of black-box test cases? Here the input space is the set of
all possible lists of ints. We need to try some typical inputs and also consider
boundary cases. Based on this spec, boundary cases include the following:</p>
<ul class="simple">
<li><p>A list containing one element. In fact, an empty list is probably the first
boundary case we think of. Looking at the spec above, we realize that it
doesn’t specify what happens in the case of an empty list. Thus, thinking
about boundary cases is also useful in identifying errors in the
specification.</p></li>
<li><p>A list containing two elements.</p></li>
<li><p>A list in which the maximum is the first element. Or the last element. Or
somewhere in the middle of the list.</p></li>
<li><p>A list in which every element is equal.</p></li>
<li><p>A list in which the elements are arranged in ascending sorted order, and one
in which they are arranged in descending sorted order.</p></li>
<li><p>A list in which the maximum element is <code class="docutils literal notranslate"><span class="pre">max_int</span></code>, and a list in which the
maximum element is <code class="docutils literal notranslate"><span class="pre">min_int</span></code>.</p></li>
</ul>
<p><strong>Example 3.</strong></p>
<p>Consider the function <code class="docutils literal notranslate"><span class="pre">sqrt</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="c">(** [sqrt x n] is the square root of [x] computed to an accuracy of [n]</span>
<span class="c">    significant digits.</span>
<span class="c">    Requires: [x &gt;= 0] and [n &gt;= 1]. *)</span>
<span class="k">val</span> <span class="n">sqrt</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">-&gt;</span> <span class="kt">int</span> <span class="o">-&gt;</span> <span class="kt">float</span>
</pre></div>
</div>
<p>The precondition identifies two possibilities for <code class="docutils literal notranslate"><span class="pre">x</span></code> (either it is 0 or
greater) and two possibilities for <code class="docutils literal notranslate"><span class="pre">n</span></code> (either it is 1 or greater). That leads
to four “paths through the specification”, i.e., representative and boundary
cases for satisfying the precondition, which we should test:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is 0 and <code class="docutils literal notranslate"><span class="pre">n</span></code> is 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is greater than 0 and <code class="docutils literal notranslate"><span class="pre">n</span></code> is 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is 0 and <code class="docutils literal notranslate"><span class="pre">n</span></code> is greater than 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is greater than 0 and <code class="docutils literal notranslate"><span class="pre">n</span></code> is greater than 1.</p></li>
</ul>
</section>
<section id="black-box-testing-of-data-abstractions">
<h2><span class="section-number">6.5.2. </span>Black-box Testing of Data Abstractions<a class="headerlink" href="#black-box-testing-of-data-abstractions" title="Permalink to this heading">#</a></h2>
<p>So far we’ve been thinking about testing just one function at a time. But data
abstractions usually have many operations, and we need to test how those
operations interact with one another. It’s useful to distinguish <em>consumer</em> and
<em>producers</em> of the data abstraction:</p>
<ul class="simple">
<li><p>A consumer is an operation that takes a value of the data abstraction as
input.</p></li>
<li><p>A producer is an operation that returns a value of the data abstraction
as output.</p></li>
</ul>
<p>For example, consider this set abstraction:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">Set</span> <span class="o">=</span> <span class="k">sig</span>

  <span class="c">(** [&#39;a t] is the type of a set whose elements have type [&#39;a]. *)</span>
  <span class="k">type</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span>

  <span class="c">(** [empty] is the empty set. *)</span>
  <span class="k">val</span> <span class="n">empty</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span>

  <span class="c">(** [size s] is the number of elements in [s]. *</span>
<span class="c">      [size empty] is [0]. *)</span>
  <span class="k">val</span> <span class="n">size</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">int</span>

  <span class="c">(** [add x s] is a set containing all the elements of</span>
<span class="c">      [s] as well as element [x]. *)</span>
  <span class="k">val</span> <span class="n">add</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span>

  <span class="c">(** [mem x s] is [true] iff [x] is an element of [s]. *)</span>
  <span class="k">val</span> <span class="n">mem</span> <span class="o">:</span> <span class="k">&#39;</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="k">&#39;</span><span class="n">a</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">bool</span>

<span class="k">end</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type Set =
  sig
    type &#39;a t
    val empty : &#39;a t
    val size : &#39;a t -&gt; int
    val add : &#39;a -&gt; &#39;a t -&gt; &#39;a t
    val mem : &#39;a -&gt; &#39;a t -&gt; bool
  end
</pre></div>
</div>
</div>
</details>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">empty</span></code> and <code class="docutils literal notranslate"><span class="pre">add</span></code> functions are producers; and the <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">add</span></code> and <code class="docutils literal notranslate"><span class="pre">mem</span></code>
functions are consumers.</p>
<p>When black-box testing a data abstraction, we should test how each consumer of
the data abstraction handles every path through each producer of it. In the
<code class="docutils literal notranslate"><span class="pre">Set</span></code> example, that means testing the following:</p>
<ul class="simple">
<li><p>how <code class="docutils literal notranslate"><span class="pre">size</span></code> handles the <code class="docutils literal notranslate"><span class="pre">empty</span></code> set;</p></li>
<li><p>how <code class="docutils literal notranslate"><span class="pre">size</span></code> handles a set produced by <code class="docutils literal notranslate"><span class="pre">add</span></code>, both when <code class="docutils literal notranslate"><span class="pre">add</span></code> leaves the set
unchanged as well as when it increases the set;</p></li>
<li><p>how <code class="docutils literal notranslate"><span class="pre">add</span></code> handles sets produced by <code class="docutils literal notranslate"><span class="pre">empty</span></code> as well as <code class="docutils literal notranslate"><span class="pre">add</span></code> itself;</p></li>
<li><p>how <code class="docutils literal notranslate"><span class="pre">mem</span></code> handles sets produced by <code class="docutils literal notranslate"><span class="pre">empty</span></code> as well as <code class="docutils literal notranslate"><span class="pre">add</span></code>, including paths
where <code class="docutils literal notranslate"><span class="pre">mem</span></code> is invoked on elements that have been added as well as elements
that have not.</p></li>
</ul>
</section>
<section id="glass-box-testing">
<h2><span class="section-number">6.5.3. </span>Glass-box Testing<a class="headerlink" href="#glass-box-testing" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/128hYUobA_g" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>Black-box testing is a good place to start when writing test cases, but
ultimately it is not enough. In particular, it’s not possible to determine how
much coverage of the implementation a black-box test suite actually
achieves—we actually need to know the implementation source code. Testing
based on that code is known as <em>glass box</em> or <em>white box</em> testing. Glass-box
testing can improve on black-box by testing <em>execution paths</em> through the
implementation code: the series of expressions that is conditionally evaluated
based on if-expressions, match-expressions, and function applications. Test
cases that collectively exercise all paths are said to be <em>path-complete</em>. At a
minimum, path-completeness requires that for every line of code, and even for
every expression in the program, there should be a test case that causes it to
be executed. Any unexecuted code could contain a bug if it has never been
tested.</p>
<p>For true path completeness we must consider all possible execution paths from
start to finish of each function, and try to exercise every distinct path. In
general this is infeasible, because there are too many paths. A good approach is
to think of the set of paths as the space that we are trying to explore, and to
identify boundary cases within this space that are worth testing.</p>
<p>For example, consider the following implementation of a function that finds the
maximum of its three arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">max3</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">=</span>
  <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="k">then</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">z</span> <span class="k">then</span> <span class="n">x</span> <span class="k">else</span> <span class="n">z</span>
  <span class="k">else</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="n">z</span> <span class="k">then</span> <span class="n">y</span> <span class="k">else</span> <span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val max3 : &#39;a -&gt; &#39;a -&gt; &#39;a -&gt; &#39;a = &lt;fun&gt;
</pre></div>
</div>
</div>
</div>
<p>Black-box testing might lead us to invent many tests, but looking at the
implementation reveals that there are only four paths through the code—the
paths that return <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, or <code class="docutils literal notranslate"><span class="pre">z</span></code> (again). We could test each of those
paths with representative inputs such as: <code class="docutils literal notranslate"><span class="pre">max3</span> <span class="pre">3</span> <span class="pre">2</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">max3</span> <span class="pre">3</span> <span class="pre">2</span> <span class="pre">4</span></code>,
<code class="docutils literal notranslate"><span class="pre">max3</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">max3</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span></code>.</p>
<p>When doing glass box testing, we should include test cases for each branch of
each (nested) if expression, and each branch of each (nested) pattern match. If
there are recursive functions, we should include test cases for the base cases
as well as each recursive call. Also, we should include test cases to trigger
each place where an exception might be raised.</p>
<p>Of course, path complete testing does not guarantee an absence of errors. We
still need to test against the specification, i.e., do black-box testing. For
example, here is a broken implementation of <code class="docutils literal notranslate"><span class="pre">max3</span></code>:</p>
<div class="highlight-ocaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">max3</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x</span>
</pre></div>
</div>
<p>The test <code class="docutils literal notranslate"><span class="pre">max3</span> <span class="pre">2</span> <span class="pre">1</span> <span class="pre">1</span></code> is path complete, but doesn’t reveal the error.</p>
</section>
<section id="glass-box-testing-of-data-abstractions">
<h2><span class="section-number">6.5.4. </span>Glass-box Testing of Data Abstractions<a class="headerlink" href="#glass-box-testing-of-data-abstractions" title="Permalink to this heading">#</a></h2>
<p>Look at the abstraction function and representation invariant for hints about
what boundaries may exist in the space of values manipulated by a data
abstraction. The rep invariant is a particularly effective tool for constructing
useful test cases. Looking at the rep invariant of the <code class="docutils literal notranslate"><span class="pre">Rational</span></code> data
abstraction above, we see that it requires that <code class="docutils literal notranslate"><span class="pre">q</span></code> is non-zero. Therefore, we
should construct test cases to see whether it’s possible to cause that invariant
to be violated.</p>
</section>
<section id="black-box-vs-glass-box">
<h2><span class="section-number">6.5.5. </span>Black-box vs. Glass-box<a class="headerlink" href="#black-box-vs-glass-box" title="Permalink to this heading">#</a></h2>
<p>Black-box testing has some important advantages:</p>
<ul class="simple">
<li><p>It doesn’t require that we see the code we are testing. Sometimes
code will not be available in source code form, yet we can still
construct useful test cases without it. The person writing the test
cases does not need to understand the implementation.</p></li>
<li><p>The test cases do not depend on the implementation. They can be
written in parallel with or before the implementation. Further, good
black-box test cases do not need to be changed, even if the
implementation is completely rewritten.</p></li>
<li><p>Constructing black-box test cases causes the programmer to think
carefully about the specification and its implications. Many
specification errors are caught this way.</p></li>
</ul>
<p>The disadvantage of black box testing is that its coverage may not be as
high as we’d like, because it has to work without the implementation.</p>
</section>
<section id="bisect">
<h2><span class="section-number">6.5.6. </span>Bisect<a class="headerlink" href="#bisect" title="Permalink to this heading">#</a></h2>
<div class="container16x9"><iframe src="https://www.youtube.com/embed/efAvB6KuHLY" class="responsive-iframe" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p>Glass-box testing can be aided by <em>code-coverage tools</em> that assess how much of
the code has been exercised by a test suite. The <a class="reference external" href="https://github.com/aantron/bisect_ppx">bisect_ppx</a> tool for OCaml
can tell you which expressions in your program have been tested, and which have
not. Here’s how it works:</p>
<ul class="simple">
<li><p>You compile your code using Bisect_ppx (henceforth, just Bisect for short) as
part of the compilation process. It <em>instruments</em> your code, mainly by
inserting additional expressions to be evaluated.</p></li>
<li><p>You run your code. The instrumentation that Bisect inserted causes your
program to do something in addition to whatever functionality you programmed
yourself: the program will now record which expressions from the source code
actually get executed at run time, and which do not. Also, the program will
now produce an output file that contains that information.</p></li>
<li><p>You run a tool called <code class="docutils literal notranslate"><span class="pre">bisect-ppx-report</span></code> on that output file. It produces
HTML showing you which parts of your code got executed, and which did not.</p></li>
</ul>
<p>How does that help with computing coverage of a test suite? If you run your
OUnit test suite, the test cases in it will cause the code in whatever functions
they test to be executed. If you don’t have enough test cases, some code in your
functions will never be executed. The report produced by Bisect will show you
exactly what code that is. You can then design new glass-box test cases to cause
that code to execute, add them to your OUnit suite, and create a new Bisect
report to confirm that the code really did get executed.</p>
<p><strong>Bisect Tutorial.</strong></p>
<ol class="arabic">
<li><p>Download the file <a href="../../code/sorts.ml">sorts.ml</a>. You will
find an implementation of insertion sort and merge sort.</p></li>
<li><p>Download the file <a href="../../code/test_sorts.ml">test_sorts.ml</a>. It
has the skeleton for an OUnit test suite.</p></li>
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">dune</span></code> file to execute <code class="docutils literal notranslate"><span class="pre">test_sorts</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(executable
 (name test_sorts)
 (libraries ounit2)
 (instrumentation
  (backend bisect_ppx)))
</pre></div>
</div>
</li>
<li><p>Run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dune<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--instrument-with<span class="w"> </span>bisect_ppx<span class="w"> </span>./test_sorts.exe
</pre></div>
</div>
<p>That will execute the test suite with Bisect coverage enabled, causing some
files named <code class="docutils literal notranslate"><span class="pre">bisectNNNN.coverage</span></code> to be produced.</p>
</li>
<li><p>Run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bisect-ppx-report<span class="w"> </span>html
</pre></div>
</div>
<p>to generate the Bisect report from your test suite execution.  The report
is in a newly-created directory named <code class="docutils literal notranslate"><span class="pre">_coverage</span></code>.</p>
</li>
<li><p>Open the file <code class="docutils literal notranslate"><span class="pre">_coverage/index.html</span></code> in a web browser. Look at the per-file
coverage; you’ll see we’ve managed to test a few percent of <code class="docutils literal notranslate"><span class="pre">sorts.ml</span></code> with
our test suite so far. Click on the link in that report for <code class="docutils literal notranslate"><span class="pre">sorts.ml</span></code>.
You’ll see that we’ve managed to cover only one line of the source code.</p></li>
<li><p>There are some additional tests in the test file. Try uncommenting those, as
documented in the test file, and increasing your code coverage. Between each
run, you will need to delete the <code class="docutils literal notranslate"><span class="pre">bisectNNNN.coverage</span></code> files, otherwise
the report will contain information from those previous runs:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>rm<span class="w"> </span>bisect*.coverage
</pre></div>
</div>
</li>
</ol>
<p>By the time you’re done uncommenting the provided tests, you should be at 25%
coverage, including all of the insertion sort implementation. For fun, try
adding more tests to get 100% coverage of merge sort.</p>
<p><strong>Parallelism.</strong> OUnit will by default attempt to run some of the tests in
parallel, which reduces the time it takes to run a large test suite, at the
tradeoff of making it nondeterministic in what order the tests run. It’s
possible for that to affect coverage if you are testing imperative code. To make
the tests run one at a time, in order, you can pass the flag
<code class="docutils literal notranslate"><span class="pre">-runner</span> <span class="pre">sequential</span></code> to the executable. OUnit will see that flag and cease
parallelization:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dune<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>--instrument-with<span class="w"> </span>bisect_ppx<span class="w"> </span>./test_sorts.exe<span class="w"> </span>--<span class="w"> </span>-runner<span class="w"> </span>sequential
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cs3110/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ocaml-jupyter"
        },
        kernelOptions: {
            name: "ocaml-jupyter",
            path: "./chapters/correctness"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ocaml-jupyter'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="test_debug.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.4. </span>Testing and Debugging</p>
      </div>
    </a>
    <a class="right-next"
       href="randomized.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.6. </span>Randomized Testing with QCheck</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-testing">6.5.1. Black-box Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-testing-of-data-abstractions">6.5.2. Black-box Testing of Data Abstractions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glass-box-testing">6.5.3. Glass-box Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#glass-box-testing-of-data-abstractions">6.5.4. Glass-box Testing of Data Abstractions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#black-box-vs-glass-box">6.5.5. Black-box vs. Glass-box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bisect">6.5.6. Bisect</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael R. Clarkson et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>