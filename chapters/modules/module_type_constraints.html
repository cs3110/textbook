

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5.7. Module Type Constraints &#8212; OCaml Programming: Correct + Efficient + Beautiful</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/modules/module_type_constraints';</script>
    <link rel="shortcut icon" href="../../_static/op_lotus.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.8. Includes" href="includes.html" />
    <link rel="prev" title="5.6. Functional Data Structures" href="functional_data_structures.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../cover.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/op_lotus_title.png" class="logo__image only-light" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>
    <script>document.write(`<img src="../../_static/op_lotus_title.png" class="logo__image only-dark" alt="OCaml Programming: Correct + Efficient + Beautiful - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preface</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preface/about.html">About This Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preface/install.html">Installing OCaml</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/intro.html">1. Better Programming Through OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/past.html">1.1. The Past of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/present.html">1.2. The Present of OCaml</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/future.html">1.3. Look to Your Future</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/3110.html">1.4. A Brief History of CS 3110</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/summary.html">1.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics/intro.html">2. The Basics of OCaml</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/toplevel.html">2.1. The OCaml Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/compiling.html">2.2. Compiling OCaml Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/expressions.html">2.3. Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/functions.html">2.4. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/documentation.html">2.5. Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/printing.html">2.6. Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/debugging.html">2.7. Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/summary.html">2.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/exercises.html">2.9. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">OCaml Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/intro.html">3. Data and Types</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/lists.html">3.1. Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/variants.html">3.2. Variants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/ounit.html">3.3. Unit Testing with OUnit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/records_tuples.html">3.4. Records and Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/pattern_matching_advanced.html">3.5. Advanced Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/type_synonym.html">3.6. Type Synonyms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/options.html">3.7. Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/assoc_list.html">3.8. Association Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/algebraic_data_types.html">3.9. Algebraic Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/exceptions.html">3.10. Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/trees.html">3.11. Example: Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/nats.html">3.12. Example: Natural Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/summary.html">3.13. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/exercises.html">3.14. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hop/intro.html">4. Higher-Order Programming</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../hop/higher_order.html">4.1. Higher-Order Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/map.html">4.2. Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/filter.html">4.3. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/fold.html">4.4. Fold</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/beyond_lists.html">4.5. Beyond Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/pipelining.html">4.6. Pipelining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/currying.html">4.7. Currying</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/summary.html">4.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hop/exercises.html">4.9. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">5. Modular Programming</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module_systems.html">5.1. Module Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">5.2. Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="toplevel.html">5.3. Modules and the Toplevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="encapsulation.html">5.4. Encapsulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="compilation_units.html">5.5. Compilation Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional_data_structures.html">5.6. Functional Data Structures</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.7. Module Type Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="includes.html">5.8. Includes</a></li>
<li class="toctree-l2"><a class="reference internal" href="functors.html">5.9. Functors</a></li>
<li class="toctree-l2"><a class="reference internal" href="summary.html">5.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises.html">5.11. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Correctness and Efficiency</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../correctness/intro.html">6. Correctness</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../correctness/specifications.html">6.1. Specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/function_docs.html">6.2. Function Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/module_docs.html">6.3. Module Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/test_debug.html">6.4. Testing and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/black_glass_box.html">6.5. Black-box and Glass-box Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/randomized.html">6.6. Randomized Testing with QCheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/proving_correctness.html">6.7. Proving Correctness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/structural_induction.html">6.8. Structural Induction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/alg_spec.html">6.9. Algebraic Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/summary.html">6.10. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../correctness/exercises.html">6.11. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mut/intro.html">7. Mutability</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mut/refs.html">7.1. Refs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/mutable_fields.html">7.2. Mutable Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/arrays.html">7.3. Arrays and Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/summary.html">7.4. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mut/exercises.html">7.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ds/intro.html">8. Data Structures</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ds/hash_tables.html">8.1. Hash Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/amortized.html">8.2. Amortized Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/rb.html">8.3. Red-Black Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/sequence.html">8.4. Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/memoization.html">8.5. Memoization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/promises.html">8.6. Promises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/monads.html">8.7. Monads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/summary.html">8.8. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ds/exercises.html">8.9. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Language Implementation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../interp/intro.html">9. Interpreters</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../interp/calculator.html">9.1. Example: Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/parsing.html">9.2. Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/substitution.html">9.3. Substitution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/environment.html">9.4. Environment Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/typecheck.html">9.5. Type Checking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/inference.html">9.6. Type Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/summary.html">9.7. Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interp/exercises.html">9.8. Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lagniappe</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../adv/curry-howard.html">The Curry-Howard Correspondence</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/bigoh.html">Big-Oh Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/vm.html">Virtual Machine</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cs3110/textbook/main?urlpath=tree/src/chapters/modules/module_type_constraints.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cs3110/textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/edit/main/src/chapters/modules/module_type_constraints.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cs3110/textbook/issues/new?title=Issue%20on%20page%20%2Fchapters/modules/module_type_constraints.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/modules/module_type_constraints.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../../_sources/chapters/modules/module_type_constraints.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Module Type Constraints</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specializing-module-types">5.7.1. Specializing Module Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constraints">5.7.2. Constraints</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="module-type-constraints">
<h1><span class="section-number">5.7. </span>Module Type Constraints<a class="headerlink" href="#module-type-constraints" title="Permalink to this heading">#</a></h1>
<p>We have extolled the virtues of encapsulation. Now we’re going to do something
that might seem counter-intuitive: selectively violate encapsulation.</p>
<p>As a motivating example, here is a module type that represents values that
support the usual addition and multiplication operations from arithmetic, or more precisely, a <em><a class="reference external" href="https://en.wikipedia.org/wiki/Ring_(mathematics)">ring</a></em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">Ring</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="k">type</span> <span class="n">t</span>
  <span class="k">val</span> <span class="n">zero</span> <span class="o">:</span> <span class="n">t</span>
  <span class="k">val</span> <span class="n">one</span> <span class="o">:</span> <span class="n">t</span>
  <span class="k">val</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
  <span class="k">val</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>
  <span class="k">val</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">t</span>  <span class="c">(* additive inverse *)</span>
  <span class="k">val</span> <span class="n">to_string</span> <span class="o">:</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="kt">string</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type Ring =
  sig
    type t
    val zero : t
    val one : t
    val ( + ) : t -&gt; t -&gt; t
    val ( * ) : t -&gt; t -&gt; t
    val ( ~- ) : t -&gt; t
    val to_string : t -&gt; string
  end
</pre></div>
</div>
</div>
</div>
<p>Recall that we must write <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">*</span> <span class="pre">)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">(*)</span></code> because the latter would be
parsed as beginning a comment. And we write the <code class="docutils literal notranslate"><span class="pre">~</span></code> in <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">~-</span> <span class="pre">)</span></code> to indicate a
<em>unary</em> operator.</p>
<p>This is a bit weird of an example. We don’t normally think of numbers as a data
structure. But what is a data structure except for a set of values and
operations on them? The <code class="docutils literal notranslate"><span class="pre">Ring</span></code> module type makes it clear that’s what we have.</p>
<p>Here is a module that implements that module type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">IntRing</span> <span class="o">:</span> <span class="nc">Ring</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_int</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module IntRing : Ring
</pre></div>
</div>
</div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">t</span></code> is abstract, the toplevel can’t give us good output about what the
sum of one and one is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : IntRing.t = &lt;abstr&gt;
</pre></div>
</div>
</div>
</div>
<p>But we could convert it to a string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span> <span class="o">|&gt;</span> <span class="n">to_string</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : string = &quot;2&quot;
</pre></div>
</div>
</div>
</div>
<p>We could even install a pretty printer to avoid having to manually call
<code class="docutils literal notranslate"><span class="pre">to_string</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">pp_intring</span> <span class="n">fmt</span> <span class="n">i</span> <span class="o">=</span>
  <span class="nn">Format</span><span class="p">.</span><span class="n">fprintf</span> <span class="n">fmt</span> <span class="s2">&quot;%s&quot;</span> <span class="o">(</span><span class="nn">IntRing</span><span class="p">.</span><span class="n">to_string</span> <span class="n">i</span><span class="o">);;</span>

<span class="o">#</span><span class="n">install_printer</span> <span class="n">pp_intring</span><span class="o">;;</span>

<span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val pp_intring : Format.formatter -&gt; IntRing.t -&gt; unit = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : IntRing.t = 2
</pre></div>
</div>
</div>
</div>
<p>We could implement other kinds of rings, too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">FloatRing</span> <span class="o">:</span> <span class="nc">Ring</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">float</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_float</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module FloatRing : Ring
</pre></div>
</div>
</div>
</div>
<p>Then we’d have to install a printer for it, too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">let</span> <span class="n">pp_floatring</span> <span class="n">fmt</span> <span class="n">f</span> <span class="o">=</span>
  <span class="nn">Format</span><span class="p">.</span><span class="n">fprintf</span> <span class="n">fmt</span> <span class="s2">&quot;%s&quot;</span> <span class="o">(</span><span class="nn">FloatRing</span><span class="p">.</span><span class="n">to_string</span> <span class="n">f</span><span class="o">);;</span>

<span class="o">#</span><span class="n">install_printer</span> <span class="n">pp_floatring</span><span class="o">;;</span>

<span class="nn">FloatRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>val pp_floatring : Format.formatter -&gt; FloatRing.t -&gt; unit = &lt;fun&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : FloatRing.t = 2.
</pre></div>
</div>
</div>
</div>
<p>Was there really a need to make type <code class="docutils literal notranslate"><span class="pre">t</span></code> abstract in the ring examples above?
Arguably not. And if it were not abstract, we wouldn’t have to go to the trouble
of converting abstract values into strings, or installing printers. Let’s pursue
that idea, next.</p>
<section id="specializing-module-types">
<h2><span class="section-number">5.7.1. </span>Specializing Module Types<a class="headerlink" href="#specializing-module-types" title="Permalink to this heading">#</a></h2>
<p>In the past, we’ve seen that we can leave off the module type annotation,
then do a separate check to make sure the structure satisfies the signature:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">IntRing</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_int</span>
<span class="k">end</span>

<span class="k">module</span> <span class="o">_</span> <span class="o">:</span> <span class="nc">Ring</span> <span class="o">=</span> <span class="nc">IntRing</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module IntRing :
  sig
    type t = int
    val zero : int
    val one : int
    val ( + ) : int -&gt; int -&gt; int
    val ( * ) : int -&gt; int -&gt; int
    val ( ~- ) : int -&gt; int
    val to_string : int -&gt; string
  end
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : int = 2
</pre></div>
</div>
</div>
</div>
<p>There’s a more sophisticated way of accomplishing the same goal. We can
specialize the <code class="docutils literal notranslate"><span class="pre">Ring</span></code> module type to specify that <code class="docutils literal notranslate"><span class="pre">t</span></code> must be <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code>.
We do that by adding a <em>constraint</em> using the <code class="docutils literal notranslate"><span class="pre">with</span></code> keyword:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">INT_RING</span> <span class="o">=</span> <span class="nc">Ring</span> <span class="k">with</span> <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type INT_RING =
  sig
    type t = int
    val zero : t
    val one : t
    val ( + ) : t -&gt; t -&gt; t
    val ( * ) : t -&gt; t -&gt; t
    val ( ~- ) : t -&gt; t
    val to_string : t -&gt; string
  end
</pre></div>
</div>
</div>
</div>
<p>Note how the <code class="docutils literal notranslate"><span class="pre">INT_RING</span></code> module type now specifies that <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">int</span></code> are the
same type. It exposes or <em>shares</em> that fact with the world, so we could
call these “sharing constraints.”</p>
<p>Now <code class="docutils literal notranslate"><span class="pre">IntRing</span></code> can be given that module type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">IntRing</span> <span class="o">:</span> <span class="nc">INT_RING</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_int</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module IntRing : INT_RING
</pre></div>
</div>
</div>
</div>
<p>And since the equality of <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">int</span></code> is exposed, the toplevel can print
values of type <code class="docutils literal notranslate"><span class="pre">t</span></code> without any help needed from a pretty printer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="n">one</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : IntRing.t = 2
</pre></div>
</div>
</div>
</div>
<p>Programmers can even mix and match built-in <code class="docutils literal notranslate"><span class="pre">int</span></code> values with those provided
by <code class="docutils literal notranslate"><span class="pre">IntRing</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="nn">IntRing</span><span class="p">.</span><span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">one</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>- : IntRing.t = 2
</pre></div>
</div>
</div>
</div>
<p>The same can be done for floats:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">FLOAT_RING</span> <span class="o">=</span> <span class="nc">Ring</span> <span class="k">with</span> <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">float</span>

<span class="k">module</span> <span class="nc">FloatRing</span> <span class="o">:</span> <span class="nc">FLOAT_RING</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">float</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_float</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type FLOAT_RING =
  sig
    type t = float
    val zero : t
    val one : t
    val ( + ) : t -&gt; t -&gt; t
    val ( * ) : t -&gt; t -&gt; t
    val ( ~- ) : t -&gt; t
    val to_string : t -&gt; string
  end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module FloatRing : FLOAT_RING
</pre></div>
</div>
</div>
</div>
<p>It turns out there’s no need to separately define <code class="docutils literal notranslate"><span class="pre">INT_RING</span></code> and <code class="docutils literal notranslate"><span class="pre">FLOAT_RING</span></code>.
The <code class="docutils literal notranslate"><span class="pre">with</span></code> keyword can be used as part of the <code class="docutils literal notranslate"><span class="pre">module</span></code> definition, though the
syntax becomes a little harder to read because of the proximity of the two <code class="docutils literal notranslate"><span class="pre">=</span></code>
signs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="nc">FloatRing</span> <span class="o">:</span> <span class="nc">Ring</span> <span class="k">with</span> <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">float</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">float</span>
  <span class="k">let</span> <span class="n">zero</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span>
  <span class="k">let</span> <span class="n">one</span> <span class="o">=</span> <span class="mi">1</span><span class="o">.</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">+</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">+.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">*</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">*.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="o">(</span> <span class="o">~-</span> <span class="o">)</span> <span class="o">=</span> <span class="nn">Stdlib</span><span class="p">.</span><span class="o">(</span> <span class="o">~-.</span> <span class="o">)</span>
  <span class="k">let</span> <span class="n">to_string</span> <span class="o">=</span> <span class="n">string_of_float</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module FloatRing :
  sig
    type t = float
    val zero : t
    val one : t
    val ( + ) : t -&gt; t -&gt; t
    val ( * ) : t -&gt; t -&gt; t
    val ( ~- ) : t -&gt; t
    val to_string : t -&gt; string
  end
</pre></div>
</div>
</div>
</div>
</section>
<section id="constraints">
<h2><span class="section-number">5.7.2. </span>Constraints<a class="headerlink" href="#constraints" title="Permalink to this heading">#</a></h2>
<p><strong>Syntax.</strong></p>
<p>There are two sorts of constraints. One is the sort we saw above, with <code class="docutils literal notranslate"><span class="pre">type</span></code>
equations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">with</span> <span class="pre">type</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">t</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is a module type, <code class="docutils literal notranslate"><span class="pre">x</span></code> is a type name, and
<code class="docutils literal notranslate"><span class="pre">t</span></code> is a type.</p></li>
</ul>
<p>The other sort is a <code class="docutils literal notranslate"><span class="pre">module</span></code> equation, which is syntactic sugar for specifying
the equality of <em>all</em> types in the two modules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">with</span> <span class="pre">module</span> <span class="pre">M</span> <span class="pre">=</span> <span class="pre">N</span></code>, where <code class="docutils literal notranslate"><span class="pre">M</span></code> and <code class="docutils literal notranslate"><span class="pre">N</span></code> are module names.</p></li>
</ul>
<p>Multiple constraints can be added with the <code class="docutils literal notranslate"><span class="pre">and</span></code> keyword:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">with</span> <span class="pre">constraint1</span> <span class="pre">and</span> <span class="pre">constraint2</span> <span class="pre">and</span> <span class="pre">...</span> <span class="pre">constraintN</span></code></p></li>
</ul>
<p><strong>Static semantics.</strong></p>
<p>The constrained module type <code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">with</span> <span class="pre">type</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">t</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">T</span></code>, except that
the declaration of <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">x</span></code> inside <code class="docutils literal notranslate"><span class="pre">T</span></code> is replaced by <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">t</span></code>. For example,
compare the two signatures output below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">T</span> <span class="o">=</span> <span class="k">sig</span> <span class="k">type</span> <span class="n">t</span> <span class="k">end</span>
<span class="k">module</span> <span class="k">type</span> <span class="nc">U</span> <span class="o">=</span> <span class="nc">T</span> <span class="k">with</span> <span class="k">type</span> <span class="n">t</span> <span class="o">=</span> <span class="kt">int</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type T = sig type t end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type U = sig type t = int end
</pre></div>
</div>
</div>
</div>
<p>Likewise, <code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">with</span> <span class="pre">module</span> <span class="pre">M</span> <span class="pre">=</span> <span class="pre">N</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">T</span></code>, except that the any
declaration <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">x</span></code> inside the module type of <code class="docutils literal notranslate"><span class="pre">M</span></code> is replaced by
<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">N.x</span></code>. (And the same recursively for any nested modules.) It takes more
work to give and understand this example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-OCaml notranslate"><div class="highlight"><pre><span></span><span class="k">module</span> <span class="k">type</span> <span class="nc">XY</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="k">type</span> <span class="n">x</span>
  <span class="k">type</span> <span class="n">y</span>
<span class="k">end</span>

<span class="k">module</span> <span class="k">type</span> <span class="nc">T</span> <span class="o">=</span> <span class="k">sig</span>
  <span class="k">module</span> <span class="nc">A</span> <span class="o">:</span> <span class="nc">XY</span>
<span class="k">end</span>

<span class="k">module</span> <span class="nc">B</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">type</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span>
  <span class="k">type</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">float</span>
<span class="k">end</span>

<span class="k">module</span> <span class="k">type</span> <span class="nc">U</span> <span class="o">=</span> <span class="nc">T</span> <span class="k">with</span> <span class="k">module</span> <span class="nc">A</span> <span class="o">=</span> <span class="nc">B</span>

<span class="k">module</span> <span class="nc">C</span> <span class="o">:</span> <span class="nc">U</span> <span class="o">=</span> <span class="k">struct</span>
  <span class="k">module</span> <span class="nc">A</span> <span class="o">=</span> <span class="k">struct</span>
    <span class="k">type</span> <span class="n">x</span> <span class="o">=</span> <span class="kt">int</span>
    <span class="k">type</span> <span class="n">y</span> <span class="o">=</span> <span class="kt">float</span>
    <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type XY = sig type x type y end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type T = sig module A : XY end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module B : sig type x = int type y = float end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module type U = sig module A : sig type x = int type y = float end end
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module C : U
</pre></div>
</div>
</div>
</div>
<p>Focus on the output for module type <code class="docutils literal notranslate"><span class="pre">U</span></code>. Notice that the types of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> in
it have become <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">float</span></code> because of the <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">A</span> <span class="pre">=</span> <span class="pre">B</span></code> constraint. Also
notice how modules <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">C.A</span></code> are <em>not</em> the same module; the latter has an
extra item <code class="docutils literal notranslate"><span class="pre">x</span></code> in it. So the syntax <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">A</span> <span class="pre">=</span> <span class="pre">B</span></code> is potentially confusing. The
constraint is not specifying that the two <em>modules</em> are the same. Rather, it
specifies that all their <em>types</em> are constrained to be equal.</p>
<p><strong>Dynamic semantics.</strong></p>
<p>There are no dynamic semantics for constraints, because they are only for type
checking.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cs3110/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ocaml-jupyter"
        },
        kernelOptions: {
            name: "ocaml-jupyter",
            path: "./chapters/modules"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ocaml-jupyter'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="functional_data_structures.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5.6. </span>Functional Data Structures</p>
      </div>
    </a>
    <a class="right-next"
       href="includes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5.8. </span>Includes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specializing-module-types">5.7.1. Specializing Module Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constraints">5.7.2. Constraints</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael R. Clarkson et al.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>